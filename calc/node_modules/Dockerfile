FROM node:alpine

# Install MySQL connector for Node.js and other dependencies
RUN apk add --no-cache mariadb-dev \
  && apk add --no-cache --virtual .build-deps \
    build-base \
    mariadb-connector-c-dev \
    python3 \
    py3-pip \
  && npm install mysql2 \
  && apk del .build-deps

# Set the working directory to /app
WORKDIR /app

# Copy the package.json and package-lock.json files to the working directory
COPY package*.json ./

# Install the dependencies
RUN npm install

# Copy the index.html file to the root directory
COPY index.html /

# Expose port 8080
EXPOSE 8080

# Start the server and insert the results into the MySQL database
CMD ["sh", "-c", "node server.js"]
